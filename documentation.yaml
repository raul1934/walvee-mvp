openapi: 3.0.0
info:
  title: Walvee API
  version: 1.0.0
  description: |
    # Walvee Travel Itinerary API

    Complete REST API documentation for the Walvee travel itinerary sharing platform.

    ## Authentication

    This API uses Google OAuth 2.0 for authentication with JWT tokens.

    ### Authentication Flow:

    1. **Initiate Login**: Navigate to `GET /v1/auth/google`
    2. **User Sign-in**: User completes Google OAuth in browser
    3. **Callback**: Google redirects to `/v1/auth/google/callback`
    4. **Token Issued**: Server generates JWT token and redirects to frontend
    5. **Use Token**: Include token in `Authorization: Bearer {token}` header

    ### Token Information:
    - **Access Token Expiry**: 7 days
    - **Refresh Token Expiry**: 30 days
    - **Refresh Endpoint**: `POST /v1/auth/refresh`

    ## Rate Limiting

    - **General**: 100 requests per 15 minutes per IP
    - **File Upload**: 10 uploads per minute

    ## Pagination

    All list endpoints support pagination with these query parameters:
    - `page`: Page number (default: 1)
    - `limit`: Items per page (default: 20, max: 100)
    - `sortBy`: Field to sort by (default: `createdAt`)
    - `order`: `asc` or `desc` (default: `desc`)

    ## Error Codes

    - `400`: Bad Request - Invalid input
    - `401`: Unauthorized - Missing or invalid token
    - `403`: Forbidden - Insufficient permissions
    - `404`: Not Found - Resource doesn't exist
    - `429`: Too Many Requests - Rate limit exceeded
    - `500`: Internal Server Error - Server error

  contact:
    name: Walvee Support
    email: support@walvee.com
  license:
    name: Proprietary

servers:
  - url: https://api.walvee.com/v1
    description: Production server
  - url: http://localhost:3000/v1
    description: Development server

tags:
  - name: Authentication
    description: Google OAuth and JWT token management
  - name: Users
    description: User profile and account operations
  - name: Trips
    description: Travel itinerary CRUD operations
  - name: Trip Likes
    description: Favorite/like trip operations
  - name: Follows
    description: User following relationships
  - name: Reviews
    description: Place and trip reviews
  - name: Trip Derivations
    description: Trip stealing/copying operations
  - name: Upload
    description: File and image upload operations

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token obtained from Google OAuth callback

  responses:
    BadRequest:
      description: Bad Request - Validation error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            success: false
            error:
              code: VALIDATION_ERROR
              message: Validation failed
              details:
                - field: title
                  message: Title is required

    Unauthorized:
      description: Unauthorized - Missing or invalid token
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            success: false
            error:
              code: UNAUTHORIZED
              message: No token provided
              details: []

    Forbidden:
      description: Forbidden - Insufficient permissions
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            success: false
            error:
              code: FORBIDDEN
              message: You do not have permission to perform this action
              details: []

    NotFound:
      description: Not Found - Resource doesn't exist
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            success: false
            error:
              code: RESOURCE_NOT_FOUND
              message: Resource not found
              details: []

    InternalServerError:
      description: Internal Server Error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            success: false
            error:
              code: INTERNAL_SERVER_ERROR
              message: An unexpected error occurred
              details: []

  schemas:
    # ==================== COMMON SCHEMAS ====================

    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          example: false
        error:
          type: object
          required:
            - code
            - message
          properties:
            code:
              type: string
              enum:
                - VALIDATION_ERROR
                - UNAUTHORIZED
                - FORBIDDEN
                - RESOURCE_NOT_FOUND
                - INTERNAL_SERVER_ERROR
              example: VALIDATION_ERROR
            message:
              type: string
              example: Validation failed
            details:
              type: array
              items:
                type: object
                properties:
                  field:
                    type: string
                  message:
                    type: string

    PaginationMeta:
      type: object
      properties:
        page:
          type: integer
          example: 1
        limit:
          type: integer
          example: 20
        total:
          type: integer
          example: 150
        totalPages:
          type: integer
          example: 8
        hasNext:
          type: boolean
          example: true
        hasPrev:
          type: boolean
          example: false

    # ==================== USER SCHEMAS ====================

    User:
      type: object
      required:
        - id
        - email
        - fullName
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        email:
          type: string
          format: email
          example: user@example.com
        googleId:
          type: string
          example: "106123456789012345678"
        fullName:
          type: string
          example: John Doe
        preferredName:
          type: string
          example: John
        photoUrl:
          type: string
          format: uri
          example: https://storage.googleapis.com/walvee-uploads/images/user123/profile.jpg
        bio:
          type: string
          example: Travel enthusiast exploring the world
        city:
          type: string
          example: San Francisco
        country:
          type: string
          example: United States
        instagramUsername:
          type: string
          example: johndoe_travels
        metricsFollowers:
          type: integer
          example: 42
        metricsFollowing:
          type: integer
          example: 28
        metricsTrips:
          type: integer
          example: 15
        metricsLikesReceived:
          type: integer
          example: 234
        onboardingCompleted:
          type: boolean
          example: true
        createdAt:
          type: string
          format: date-time
          example: "2025-01-15T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          example: "2025-01-16T14:20:00Z"

    UpdateUserRequest:
      type: object
      properties:
        fullName:
          type: string
          minLength: 1
          maxLength: 255
        preferredName:
          type: string
          maxLength: 100
        bio:
          type: string
          maxLength: 5000
        city:
          type: string
          maxLength: 100
        country:
          type: string
          maxLength: 100
        instagramUsername:
          type: string
          maxLength: 50
        photoUrl:
          type: string
          format: uri
        onboardingCompleted:
          type: boolean

    # ==================== TRIP SCHEMAS ====================

    Trip:
      type: object
      required:
        - id
        - title
        - destination
        - durationDays
        - createdBy
        - authorName
        - authorEmail
        - itinerary
        - visibility
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
          example: 660e8400-e29b-41d4-a716-446655440001
        title:
          type: string
          example: 5 Days in Tokyo
        destination:
          type: string
          example: Tokyo, Japan
        description:
          type: string
          example: Experience the best of Tokyo with traditional temples, modern skyscrapers, and amazing food
        durationDays:
          type: integer
          minimum: 1
          example: 5
        createdBy:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        authorName:
          type: string
          example: John Doe
        authorPhoto:
          type: string
          format: uri
          example: https://storage.googleapis.com/walvee-uploads/images/user123/profile.jpg
        authorEmail:
          type: string
          format: email
          example: user@example.com
        imageUrl:
          type: string
          format: uri
          example: https://images.unsplash.com/photo-tokyo
        images:
          type: array
          items:
            type: string
            format: uri
          example:
            - https://images.unsplash.com/photo-tokyo-1
            - https://images.unsplash.com/photo-tokyo-2
        locations:
          type: array
          items:
            type: string
          example:
            - Tokyo
            - Shibuya
            - Asakusa
        destinationLat:
          type: number
          format: double
          example: 35.6762
        destinationLng:
          type: number
          format: double
          example: 139.6503
        itinerary:
          type: array
          items:
            $ref: '#/components/schemas/ItineraryDay'
        visibility:
          type: string
          enum: [public, private]
          example: public
        likes:
          type: integer
          example: 42
        steals:
          type: integer
          example: 8
        shares:
          type: integer
          example: 15
        createdAt:
          type: string
          format: date-time
          example: "2025-01-15T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          example: "2025-01-16T14:20:00Z"

    ItineraryDay:
      type: object
      required:
        - day
        - places
      properties:
        day:
          type: integer
          minimum: 1
          example: 1
        places:
          type: array
          items:
            $ref: '#/components/schemas/Place'

    Place:
      type: object
      required:
        - name
        - placeId
        - order
      properties:
        name:
          type: string
          example: Senso-ji Temple
        placeId:
          type: string
          example: ChIJAcBYqRGMGGARDva8VAl_j6A
        address:
          type: string
          example: 2 Chome-3-1 Asakusa, Taito City, Tokyo 111-0032, Japan
        formattedAddress:
          type: string
          example: 2-3-1 Asakusa, Taito City, Tokyo 111-0032, Japan
        description:
          type: string
          example: Tokyo's oldest temple with impressive architecture
        rating:
          type: number
          format: float
          minimum: 0
          maximum: 5
          example: 4.5
        priceLevel:
          type: integer
          minimum: 0
          maximum: 4
          example: 0
        types:
          type: array
          items:
            type: string
          example:
            - tourist_attraction
            - place_of_worship
            - point_of_interest
        photos:
          type: array
          items:
            type: string
            format: uri
          example:
            - https://storage.googleapis.com/walvee-uploads/places/sensoji-1.jpg
        photo:
          type: string
          format: uri
          example: https://storage.googleapis.com/walvee-uploads/places/sensoji-1.jpg
        order:
          type: integer
          minimum: 0
          example: 1
        userRatingsTotal:
          type: integer
          example: 15234
        website:
          type: string
          format: uri
          example: https://www.senso-ji.jp
        formattedPhoneNumber:
          type: string
          example: +81 3-3842-0181
        openingHours:
          type: object
          properties:
            weekdayText:
              type: array
              items:
                type: string
              example:
                - "Monday: 6:00 AM – 5:00 PM"
                - "Tuesday: 6:00 AM – 5:00 PM"
        geometry:
          type: object
          properties:
            location:
              type: object
              properties:
                lat:
                  type: number
                  format: double
                  example: 35.7148
                lng:
                  type: number
                  format: double
                  example: 139.7967

    CreateTripRequest:
      type: object
      required:
        - title
        - destination
        - durationDays
        - itinerary
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 200
          example: 5 Days in Tokyo
        destination:
          type: string
          minLength: 1
          maxLength: 255
          example: Tokyo, Japan
        description:
          type: string
          maxLength: 5000
          example: Experience the best of Tokyo
        durationDays:
          type: integer
          minimum: 1
          example: 5
        visibility:
          type: string
          enum: [public, private]
          default: public
          example: public
        imageUrl:
          type: string
          format: uri
        images:
          type: array
          items:
            type: string
            format: uri
        locations:
          type: array
          items:
            type: string
        destinationLat:
          type: number
          format: double
        destinationLng:
          type: number
          format: double
        itinerary:
          type: array
          items:
            $ref: '#/components/schemas/ItineraryDay'

    UpdateTripRequest:
      type: object
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 200
        destination:
          type: string
          minLength: 1
          maxLength: 255
        description:
          type: string
          maxLength: 5000
        durationDays:
          type: integer
          minimum: 1
        visibility:
          type: string
          enum: [public, private]
        imageUrl:
          type: string
          format: uri
        images:
          type: array
          items:
            type: string
            format: uri
        locations:
          type: array
          items:
            type: string
        itinerary:
          type: array
          items:
            $ref: '#/components/schemas/ItineraryDay'

    # ==================== TRIP LIKE SCHEMAS ====================

    TripLike:
      type: object
      required:
        - id
        - tripId
        - likerId
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          example: 770e8400-e29b-41d4-a716-446655440002
        tripId:
          type: string
          format: uuid
          example: 660e8400-e29b-41d4-a716-446655440001
        likerId:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        createdAt:
          type: string
          format: date-time
          example: "2025-01-15T10:30:00Z"

    CreateTripLikeRequest:
      type: object
      required:
        - tripId
      properties:
        tripId:
          type: string
          format: uuid
          example: 660e8400-e29b-41d4-a716-446655440001

    # ==================== FOLLOW SCHEMAS ====================

    Follow:
      type: object
      required:
        - id
        - followerId
        - followeeId
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          example: 880e8400-e29b-41d4-a716-446655440003
        followerId:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        followeeId:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440999
        followeeEmail:
          type: string
          format: email
          example: traveler@example.com
        createdAt:
          type: string
          format: date-time
          example: "2025-01-15T10:30:00Z"

    CreateFollowRequest:
      type: object
      required:
        - followeeId
      properties:
        followeeId:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440999

    # ==================== REVIEW SCHEMAS ====================

    Review:
      type: object
      required:
        - id
        - reviewerId
        - rating
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
          example: 990e8400-e29b-41d4-a716-446655440004
        tripId:
          type: string
          format: uuid
          example: 660e8400-e29b-41d4-a716-446655440001
        placeId:
          type: string
          example: ChIJAcBYqRGMGGARDva8VAl_j6A
        reviewerId:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        rating:
          type: integer
          minimum: 1
          maximum: 5
          example: 5
        comment:
          type: string
          maxLength: 5000
          example: Amazing temple with beautiful architecture!
        createdAt:
          type: string
          format: date-time
          example: "2025-01-15T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          example: "2025-01-16T14:20:00Z"

    CreateReviewRequest:
      type: object
      required:
        - rating
      properties:
        tripId:
          type: string
          format: uuid
        placeId:
          type: string
        rating:
          type: integer
          minimum: 1
          maximum: 5
          example: 5
        comment:
          type: string
          maxLength: 5000
          example: Amazing experience!

    UpdateReviewRequest:
      type: object
      properties:
        rating:
          type: integer
          minimum: 1
          maximum: 5
        comment:
          type: string
          maxLength: 5000

    # ==================== TRIP DERIVATION SCHEMAS ====================

    TripDerivation:
      type: object
      required:
        - id
        - originalTripId
        - creatorId
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          example: aa0e8400-e29b-41d4-a716-446655440005
        originalTripId:
          type: string
          format: uuid
          example: 660e8400-e29b-41d4-a716-446655440001
        derivedTripId:
          type: string
          format: uuid
          example: 660e8400-e29b-41d4-a716-446655440999
        creatorId:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        createdAt:
          type: string
          format: date-time
          example: "2025-01-15T10:30:00Z"

    CreateTripDerivationRequest:
      type: object
      required:
        - originalTripId
      properties:
        originalTripId:
          type: string
          format: uuid
          example: 660e8400-e29b-41d4-a716-446655440001
        derivedTripId:
          type: string
          format: uuid
          example: 660e8400-e29b-41d4-a716-446655440999

paths:
  # ==================== AUTHENTICATION ENDPOINTS ====================

  /auth/google:
    get:
      tags:
        - Authentication
      summary: Initiate Google OAuth
      description: Redirects user to Google OAuth consent screen to begin authentication process
      responses:
        '302':
          description: Redirect to Google OAuth
          headers:
            Location:
              schema:
                type: string
                example: https://accounts.google.com/o/oauth2/v2/auth?...

  /auth/google/callback:
    get:
      tags:
        - Authentication
      summary: Google OAuth callback
      description: |
        Handles Google OAuth callback after user authentication.
        Creates or updates user in database and generates JWT token.
        Redirects to frontend with token in query string.
      parameters:
        - name: code
          in: query
          required: true
          schema:
            type: string
          description: Authorization code from Google
      responses:
        '302':
          description: Redirect to frontend with token
          headers:
            Location:
              schema:
                type: string
                example: http://localhost:5173/auth/callback?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        '401':
          $ref: '#/components/responses/Unauthorized'

  /auth/refresh:
    post:
      tags:
        - Authentication
      summary: Refresh access token
      description: Generates a new access token using refresh token from httpOnly cookie
      responses:
        '200':
          description: New access token generated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      token:
                        type: string
                        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                      expiresIn:
                        type: integer
                        example: 604800
        '401':
          $ref: '#/components/responses/Unauthorized'

  /auth/logout:
    post:
      tags:
        - Authentication
      summary: Logout user
      description: Invalidates refresh token cookie
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Logout successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Logged out successfully
        '401':
          $ref: '#/components/responses/Unauthorized'

  /auth/me:
    get:
      tags:
        - Authentication
      summary: Get current user
      description: Returns the profile of the currently authenticated user
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Current user profile
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/User'
        '401':
          $ref: '#/components/responses/Unauthorized'

  # ==================== USER ENDPOINTS ====================

  /users:
    get:
      tags:
        - Users
      summary: List users
      description: Get a paginated list of users with optional filtering and sorting
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
            minimum: 1
          description: Page number
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
          description: Items per page
        - name: sortBy
          in: query
          schema:
            type: string
            default: createdAt
          description: Field to sort by
        - name: order
          in: query
          schema:
            type: string
            enum: [asc, desc]
            default: desc
          description: Sort order
        - name: search
          in: query
          schema:
            type: string
          description: Search by name or email
      responses:
        '200':
          description: List of users
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'

  /users/{id}:
    get:
      tags:
        - Users
      summary: Get user by ID
      description: Returns a single user's profile
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User ID
      responses:
        '200':
          description: User profile
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/User'
        '404':
          $ref: '#/components/responses/NotFound'

  /users/me:
    put:
      tags:
        - Users
      summary: Update current user profile
      description: Update the authenticated user's profile information
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'
            example:
              fullName: John Doe Updated
              bio: Travel enthusiast exploring the world one trip at a time
              city: Los Angeles
              country: United States
              instagramUsername: johndoe_travels
      responses:
        '200':
          description: User profile updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/User'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /users/{id}/trips:
    get:
      tags:
        - Users
      summary: Get user's trips
      description: Returns all trips created by a specific user
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User ID
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: User's trips
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Trip'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '404':
          $ref: '#/components/responses/NotFound'

  /users/{id}/stats:
    get:
      tags:
        - Users
      summary: Get user statistics
      description: Returns metrics and statistics for a user
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User ID
      responses:
        '200':
          description: User statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      followers:
                        type: integer
                        example: 42
                      following:
                        type: integer
                        example: 28
                      trips:
                        type: integer
                        example: 15
                      likesReceived:
                        type: integer
                        example: 234
        '404':
          $ref: '#/components/responses/NotFound'

  # ==================== TRIP ENDPOINTS ====================

  /trips:
    get:
      tags:
        - Trips
      summary: List trips
      description: Get a paginated list of trips with filtering and sorting options
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
            maximum: 100
        - name: sortBy
          in: query
          schema:
            type: string
            default: createdAt
            enum: [createdAt, likes, title, destination]
        - name: order
          in: query
          schema:
            type: string
            enum: [asc, desc]
            default: desc
        - name: destination
          in: query
          schema:
            type: string
          description: Filter by destination (partial match)
          example: Tokyo
        - name: createdBy
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by creator user ID
        - name: visibility
          in: query
          schema:
            type: string
            enum: [public, private]
          description: Filter by visibility
        - name: minLikes
          in: query
          schema:
            type: integer
            minimum: 0
          description: Minimum number of likes
        - name: search
          in: query
          schema:
            type: string
          description: Search in title, destination, and description
      responses:
        '200':
          description: List of trips
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Trip'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
              example:
                success: true
                data:
                  - id: 660e8400-e29b-41d4-a716-446655440001
                    title: 5 Days in Tokyo
                    destination: Tokyo, Japan
                    likes: 42
                    createdAt: "2025-01-15T10:30:00Z"
                pagination:
                  page: 1
                  limit: 20
                  total: 150
                  totalPages: 8
                  hasNext: true
                  hasPrev: false

    post:
      tags:
        - Trips
      summary: Create trip
      description: Create a new travel itinerary (requires authentication)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTripRequest'
            example:
              title: 5 Days in Tokyo
              destination: Tokyo, Japan
              description: Experience the best of Tokyo with traditional temples, modern skyscrapers, and amazing food
              durationDays: 5
              visibility: public
              imageUrl: https://images.unsplash.com/photo-tokyo
              images:
                - https://images.unsplash.com/photo-tokyo-1
                - https://images.unsplash.com/photo-tokyo-2
              locations:
                - Tokyo
                - Shibuya
                - Asakusa
              destinationLat: 35.6762
              destinationLng: 139.6503
              itinerary:
                - day: 1
                  places:
                    - name: Senso-ji Temple
                      placeId: ChIJAcBYqRGMGGARDva8VAl_j6A
                      address: 2 Chome-3-1 Asakusa, Taito City, Tokyo
                      rating: 4.5
                      priceLevel: 0
                      types: [tourist_attraction, place_of_worship]
                      order: 1
                      description: Tokyo's oldest temple
                - day: 2
                  places:
                    - name: Shibuya Crossing
                      placeId: ChIJ_fake_shibuya
                      address: Shibuya, Tokyo
                      rating: 4.6
                      priceLevel: 0
                      order: 1
      responses:
        '201':
          description: Trip created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Trip'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /trips/{id}:
    get:
      tags:
        - Trips
      summary: Get trip by ID
      description: Returns a single trip with full details including itinerary
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Trip ID
      responses:
        '200':
          description: Trip details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Trip'
        '404':
          $ref: '#/components/responses/NotFound'

    put:
      tags:
        - Trips
      summary: Update trip
      description: Update an existing trip (requires authentication and ownership)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Trip ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTripRequest'
            example:
              title: 7 Days in Tokyo (Updated)
              description: Updated description with more details
              durationDays: 7
      responses:
        '200':
          description: Trip updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Trip'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'

    delete:
      tags:
        - Trips
      summary: Delete trip
      description: Delete a trip (requires authentication and ownership)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Trip ID
      responses:
        '200':
          description: Trip deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Trip deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'

  /trips/{id}/likes:
    get:
      tags:
        - Trips
      summary: Get trip likes
      description: Returns all users who liked this trip
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Trip ID
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of trip likes
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/TripLike'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '404':
          $ref: '#/components/responses/NotFound'

  /trips/{id}/reviews:
    get:
      tags:
        - Trips
      summary: Get trip reviews
      description: Returns all reviews for this trip
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Trip ID
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of reviews
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Review'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '404':
          $ref: '#/components/responses/NotFound'

  /trips/{id}/derivations:
    get:
      tags:
        - Trips
      summary: Get trip derivations
      description: Returns all derivations (steals) of this trip
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Trip ID
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of derivations
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/TripDerivation'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '404':
          $ref: '#/components/responses/NotFound'

  # ==================== TRIP LIKES ENDPOINTS ====================

  /trip-likes:
    get:
      tags:
        - Trip Likes
      summary: Get user's favorite trips
      description: Returns all trips liked by the authenticated user
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of favorite trips
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/TripLike'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'

    post:
      tags:
        - Trip Likes
      summary: Like a trip
      description: Add a trip to favorites (requires authentication)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTripLikeRequest'
            example:
              tripId: 660e8400-e29b-41d4-a716-446655440001
      responses:
        '201':
          description: Trip liked successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/TripLike'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: Trip not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /trip-likes/{id}:
    delete:
      tags:
        - Trip Likes
      summary: Unlike a trip
      description: Remove a trip from favorites (requires authentication)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Trip like ID
      responses:
        '200':
          description: Trip unliked successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Trip unliked successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'

  /trip-likes/check/{tripId}:
    get:
      tags:
        - Trip Likes
      summary: Check if user liked trip
      description: Check if the authenticated user has liked a specific trip
      security:
        - bearerAuth: []
      parameters:
        - name: tripId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Trip ID
      responses:
        '200':
          description: Like status
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      liked:
                        type: boolean
                        example: true
                      likeId:
                        type: string
                        format: uuid
                        example: 770e8400-e29b-41d4-a716-446655440002
        '401':
          $ref: '#/components/responses/Unauthorized'

  # ==================== FOLLOWS ENDPOINTS ====================

  /follows/followers/{userId}:
    get:
      tags:
        - Follows
      summary: Get user's followers
      description: Returns all users following the specified user
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User ID
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of followers
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Follow'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '404':
          $ref: '#/components/responses/NotFound'

  /follows/following/{userId}:
    get:
      tags:
        - Follows
      summary: Get users being followed
      description: Returns all users that the specified user is following
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User ID
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of users being followed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Follow'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '404':
          $ref: '#/components/responses/NotFound'

  /follows:
    post:
      tags:
        - Follows
      summary: Follow user
      description: Follow another user (requires authentication)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateFollowRequest'
            example:
              followeeId: 550e8400-e29b-41d4-a716-446655440999
      responses:
        '201':
          description: User followed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Follow'
        '400':
          description: Cannot follow yourself or already following
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /follows/{id}:
    delete:
      tags:
        - Follows
      summary: Unfollow user
      description: Unfollow a user (requires authentication)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Follow relationship ID
      responses:
        '200':
          description: User unfollowed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: User unfollowed successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'

  /follows/check/{userId}:
    get:
      tags:
        - Follows
      summary: Check if following user
      description: Check if the authenticated user is following a specific user
      security:
        - bearerAuth: []
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User ID to check
      responses:
        '200':
          description: Follow status
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      following:
                        type: boolean
                        example: true
                      followId:
                        type: string
                        format: uuid
                        example: 880e8400-e29b-41d4-a716-446655440003
        '401':
          $ref: '#/components/responses/Unauthorized'

  # ==================== REVIEWS ENDPOINTS ====================

  /reviews:
    get:
      tags:
        - Reviews
      summary: List reviews
      description: Get reviews filtered by trip or place
      parameters:
        - name: tripId
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by trip ID
        - name: placeId
          in: query
          schema:
            type: string
          description: Filter by Google Place ID
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of reviews
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Review'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'

    post:
      tags:
        - Reviews
      summary: Create review
      description: Create a review for a trip or place (requires authentication)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateReviewRequest'
            example:
              tripId: 660e8400-e29b-41d4-a716-446655440001
              placeId: ChIJAcBYqRGMGGARDva8VAl_j6A
              rating: 5
              comment: Amazing temple with beautiful architecture! Highly recommend visiting early morning.
      responses:
        '201':
          description: Review created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Review'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /reviews/{id}:
    get:
      tags:
        - Reviews
      summary: Get review by ID
      description: Returns a single review
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Review ID
      responses:
        '200':
          description: Review details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Review'
        '404':
          $ref: '#/components/responses/NotFound'

    put:
      tags:
        - Reviews
      summary: Update review
      description: Update an existing review (requires authentication and ownership)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Review ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateReviewRequest'
            example:
              rating: 4
              comment: Updated review comment
      responses:
        '200':
          description: Review updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Review'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'

    delete:
      tags:
        - Reviews
      summary: Delete review
      description: Delete a review (requires authentication and ownership)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Review ID
      responses:
        '200':
          description: Review deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Review deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'

  # ==================== TRIP DERIVATIONS ENDPOINTS ====================

  /trip-derivations:
    get:
      tags:
        - Trip Derivations
      summary: List trip derivations
      description: Get list of trip derivations (steals)
      parameters:
        - name: originalTripId
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by original trip ID
        - name: creatorId
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by creator ID
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of derivations
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/TripDerivation'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'

    post:
      tags:
        - Trip Derivations
      summary: Create trip derivation
      description: Create a derivation (steal) of an existing trip (requires authentication)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTripDerivationRequest'
            example:
              originalTripId: 660e8400-e29b-41d4-a716-446655440001
              derivedTripId: 660e8400-e29b-41d4-a716-446655440999
      responses:
        '201':
          description: Derivation created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/TripDerivation'
        '400':
          description: Cannot steal own trip
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: Original trip not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /trip-derivations/{id}:
    delete:
      tags:
        - Trip Derivations
      summary: Delete trip derivation
      description: Delete a derivation record (requires authentication and ownership)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Derivation ID
      responses:
        '200':
          description: Derivation deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Derivation deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'

  # ==================== UPLOAD ENDPOINTS ====================

  /upload/image:
    post:
      tags:
        - Upload
      summary: Upload image
      description: Upload an image file to Google Cloud Storage (requires authentication)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: Image file (jpg, jpeg, png, webp, gif)
      responses:
        '200':
          description: Image uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      fileUrl:
                        type: string
                        format: uri
                        example: https://storage.googleapis.com/walvee-uploads/images/user123/1642345678_photo.jpg
        '400':
          description: Invalid file type or size
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                error:
                  code: VALIDATION_ERROR
                  message: File must be an image
                  details: []
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          description: Too many uploads
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                error:
                  code: RATE_LIMIT_EXCEEDED
                  message: Too many upload requests. Please try again later.
                  details: []

  /upload/file:
    post:
      tags:
        - Upload
      summary: Upload file
      description: Upload a general file to Google Cloud Storage (requires authentication)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: File to upload
      responses:
        '200':
          description: File uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      fileUrl:
                        type: string
                        format: uri
                        example: https://storage.googleapis.com/walvee-uploads/uploads/user123/1642345678_document.pdf
        '400':
          description: Invalid file
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /upload/{filename}:
    delete:
      tags:
        - Upload
      summary: Delete file
      description: Delete a file from Google Cloud Storage (requires authentication and ownership)
      security:
        - bearerAuth: []
      parameters:
        - name: filename
          in: path
          required: true
          schema:
            type: string
          description: Full file path in GCS (e.g., images/user123/1642345678_photo.jpg)
      responses:
        '200':
          description: File deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: File deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
